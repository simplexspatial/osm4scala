(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{75:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return i})),a.d(t,"toc",(function(){return s})),a.d(t,"default",(function(){return b}));var n=a(3),r=a(7),o=(a(0),a(90)),l={title:"Scala library"},i={unversionedId:"standalone-scala-library",id:"standalone-scala-library",isDocsHomePage:!1,title:"Scala library",description:"With Osm4scala, you can forget about complexity of the osm.pbf format and think about a scala iterators of primitives",source:"@site/docs/standalone-scala-library.mdx",slug:"/standalone-scala-library",permalink:"/osm4scala/docs/standalone-scala-library",editUrl:"https://github.com/simplexspatial/osm4scala/edit/master/website/docs/standalone-scala-library.mdx",version:"current",sidebar:"docs",previous:{title:"Spark SQL Connector",permalink:"/osm4scala/docs/spark-connector"},next:{title:"Performance",permalink:"/osm4scala/docs/performance"}},s=[{value:"Entity iteration.",id:"entity-iteration",children:[]},{value:"Blob iteration",id:"blob-iteration",children:[]},{value:"Dependencies:  Download Core ",id:"dependencies--download-core",children:[]}],c={toc:s};function b(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"With Osm4scala, you can forget about complexity of the ",Object(o.b)("inlineCode",{parentName:"p"},"osm.pbf")," format and think about a ",Object(o.b)("strong",{parentName:"p"},"scala iterators of primitives"),"\n(nodes, ways and relations) or blob blocks."),Object(o.b)("p",null,"For example, counting all node primitives in a file is so simple as:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-scala"},"EntityIterator.fromPbf(inputStream).count(_.osmModel == OSMTypes.Node)\n")),Object(o.b)("p",null,"This is a simple example, but because the iterator nature, you can use it for more complex tasks and patterns,\nto process data at the same time you are reading with near zero memory usage, for example."),Object(o.b)("p",null,"The library allows to read the pbf file on two different ways:"),Object(o.b)("h2",{id:"entity-iteration"},"Entity iteration."),Object(o.b)("p",null,"OpenStreetMap is based in three different type of primitives:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Nodes: Represented by the ",Object(o.b)("inlineCode",{parentName:"li"},"NodeEntity")," case class."),Object(o.b)("li",{parentName:"ul"},"Ways: Represented by the ",Object(o.b)("inlineCode",{parentName:"li"},"WayEntity")," case class."),Object(o.b)("li",{parentName:"ul"},"Relations: Represented by the ",Object(o.b)("inlineCode",{parentName:"li"},"RelationEntity")," case class.")),Object(o.b)("p",null,"To iterate over all primitives in a file, the only step is create an iterator using the ",Object(o.b)("inlineCode",{parentName:"p"},"EntityIterator")," factory:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"EntityIterator.fromPbf(pbfInputStream: InputStream): EntityIterator")," allows to create an iterator from any Java\nInputStream."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"EntityIterator.fromPbf(pbfInputStream: InputStreamSentinel): EntityIterator")," allows to create an iterator from any\nJava InputStream with a sentinel to stop under the defined condition."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"EntityIterator.def fromBlob(blob: Blob): EntityIterator")," allows to read a Blob block as and iterator.")),Object(o.b)("p",null,"Every element in the iterator will be an Entity case class implementing an ",Object(o.b)("inlineCode",{parentName:"p"},"OSMEntity")," trait."),Object(o.b)("p",null,"There is an example ",Object(o.b)("a",{parentName:"p",href:"https://github.com/simplexspatial/osm4scala/tree/master/examples/counter/src/main/scala/com/acervera/osm4scala/examples/counter"},"in the repository"),"\nthat count all primitives with optional filtering by primitive type (Way, Node or Relation)."),Object(o.b)("h2",{id:"blob-iteration"},"Blob iteration"),Object(o.b)("p",null,"Sometimes, it is better to split the read in two steps. Iterate over all blobs and, secondly, iterate over all entities\nin avery blob."),Object(o.b)("p",null,"To iterate over all blobs in a file, the only step is create an iterator using the ",Object(o.b)("inlineCode",{parentName:"p"},"BlobTupleIterator")," factory:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BlobTupleIterator.fromPbf(pbfInputStream: InputStream): BlobTupleIterator")," allows to create an iterator from any Java\nInputStream."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BlobTupleIterator.fromPbf(pbfInputStream: InputStreamSentinel): BlobTupleIterator")," allows to create an iterator from any\nJava InputStream with a sentinel to stop under the defined condition.")),Object(o.b)("p",null,"Every element in the iterator will be a ",Object(o.b)("inlineCode",{parentName:"p"},"(BlobHeader, Blob)")," tuple."),Object(o.b)("p",null,"There is an example ",Object(o.b)("a",{parentName:"p",href:"https://github.com/simplexspatial/osm4scala/tree/master/examples/blocksextraction/src/main/scala/com/acervera/osm4scala/examples/blocksextraction"},"in the repository"),"\nthat extract all block from a pbf file, and store them in a folder."),Object(o.b)("h2",{id:"dependencies--download-core"},"Dependencies: ",Object(o.b)("a",{parentName:"h2",href:"https://bintray.com/angelcervera/maven/osm4scala-core/_latestVersion"}," ",Object(o.b)("img",{parentName:"a",src:"https://api.bintray.com/packages/angelcervera/maven/osm4scala-core/images/download.svg",alt:"Download Core"})," ")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Import the library using sbt."),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre",className:"language-scala"},'libraryDependencies += "com.acervera.osm4scala" %% "osm4scala-core" % "<version>"\n'))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Import the library using maven."),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n  <groupId>com.acervera.osm4scala</groupId>\n  <artifactId>osm4scala-core_${scala-version}</artifactId>\n  <version>${version}</version>\n</dependency>\n"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Only if you have problems resolving dependencies without it"),", add my bintray repo:"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre",className:"language-scala"},'resolvers += "osm4scala repo" at "http://dl.bintray.com/angelcervera/maven"\n')))))}b.isMDXComponent=!0}}]);